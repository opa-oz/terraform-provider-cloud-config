---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "cloud-config Resource - cloud-config"
subcategory: ""
description: |-
  Cloud-config file in-memory representation
---

# cloud-config (Resource)

Cloud-config file in-memory representation



<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `apk_repos` (Block, Optional) This module handles configuration of the Alpine Package Keeper (APK) /etc/apk/repositories file. (see [below for nested schema](#nestedblock--apk_repos))
- `apt_pipelining` (Block, Optional) This module configures APT’s `Acquire::http::Pipeline-Depth` option, which controls how APT handles HTTP pipelining. It may be useful for pipelining to be disabled, because some web servers (such as S3) do not pipeline properly (LP: #948461). (see [below for nested schema](#nestedblock--apt_pipelining))
- `bootcmd` (List of String) This module runs arbitrary commands very early in the boot process, only slightly after a boothook would run. This is very similar to a boothook, but more user friendly. Commands can be specified as strings.

bootcmd should only be used for things that could not be done later in the boot process.

When writing files, do not use /tmp dir as it races with systemd-tmpfiles-clean (LP: #1707222). Use /run/somedir instead.

Use of INSTANCE_ID variable within this module is deprecated. Use [jinja templates](https://cloudinit.readthedocs.io/en/latest/explanation/format.html#user-data-formats-jinja) with [ v1.instance_id ](https://cloudinit.readthedocs.io/en/latest/explanation/instancedata.html#v1-instance-id) instead.
- `byobu_by_default` (String) This module controls whether Byobu is enabled or disabled system-wide and for the default system user. If Byobu is to be enabled, this module will ensure it is installed. Likewise, if Byobu is to be disabled, it will be removed (if installed).

Valid configuration options for this module are:
 - enable-system: enable Byobu system-wide
 - enable-user: enable Byobu for the default user
 - disable-system: disable Byobu system-wide
 - disable-user: disable Byobu for the default user
 - enable: enable Byobu both system-wide and for the default user
 - disable: disable Byobu for all users
 - user: alias for enable-user
 - system: alias for enable-system
- `ca_certs` (Block, Optional) This module adds CA certificates to the system’s CA store and updates any related files using the appropriate OS-specific utility. The default CA certificates can be disabled/deleted from use by the system with the configuration option remove_defaults.

Certificates must be specified using valid YAML. To specify a multi-line certificate, the YAML multi-line list syntax must be used.

Alpine Linux requires the ca-certificates package to be installed in order to provide the update-ca-certificates command. (see [below for nested schema](#nestedblock--ca_certs))
- `chpasswd` (Block, Optional) The chpasswd config key accepts a dictionary containing either (or both) of users and expire.

 - The users key is used to assign a password to a corresponding pre-existing user.
 - The expire key is used to set whether to expire all user passwords specified by this module, such that a password will need to be reset on the user’s next login. (see [below for nested schema](#nestedblock--chpasswd))
- `create_hostname_file` (Boolean) If `false`, the hostname file (e.g. `/etc/hostname`) will not be created if it does not exist. On systems that use systemd, setting `create_hostname_file` to `false` will set the hostname transiently. If true, the hostname file will always be created and the hostname will be set statically on systemd systems. Default: `true`.
- `disable_ec2_metadata` (Boolean) Set `true` to disable IPv4 routes to EC2 metadata. Default: `false`.
- `fqdn` (String) The fully qualified domain name to set.
- `groups` (List of String) [WIP] List of user groups to create
- `hostname` (String) The hostname to set.
- `locale` (String) The locale to set as the system’s locale (e.g. ar_PS).
- `locale_configfile` (String) The file in which to write the locale configuration (defaults to the distro’s default location).
- `manage_etc_hosts` (Boolean) Whether to manage `/etc/hosts` on the system. If true, render the hosts file using `/etc/cloud/templates/hosts.tmpl` replacing `$hostname` and `$fdqn`.
- `manage_etc_hosts_localhost` (Boolean) Append a 127.0.1.1 entry that resolves from FQDN and hostname every boot.
- `package_reboot_if_required` (Boolean) Set `true` to reboot the system if required by presence of `/var/run/reboot-required`. Default: `false`.
- `package_update` (Boolean) Set `true` to update packages. Happens before upgrade or install. Default: `false`.
- `package_upgrade` (Boolean) Set `true` to upgrade packages. Happens before install. Default: `false`.
- `packages` (List of String) [WIP] An array containing a package specification
- `prefer_fqdn_over_hostname` (Boolean) If true, the fqdn will be used if it is set. If false, the hostname will be used. If unset, the result is distro-dependent.
- `preserve_hostname` (Boolean) If true, the hostname will not be changed. Default: `false`.
- `runcmd` (List of String) Run arbitrary commands at a rc.local-like time-frame with output to the console. Each item will be interpreted by `sh`.
- `ssh_authorized_keys` (List of String) The SSH public keys to add `.ssh/authorized_keys` in the default user’s home directory.
- `ssh_pwauth` (Boolean) Sets whether or not to accept password authentication. true will enable password auth. false will disable. *Default*: leave the value unchanged. 

In order for this config to be applied, SSH may need to be restarted. On systemd systems, this restart will only happen if the SSH service has already been started. On non-systemd systems, a restart will be attempted regardless of the service state.

_Changed in version 22.3. Use of non-boolean values for this field is deprecated._
- `timezone` (String) The timezone to use as represented in /usr/share/zoneinfo.
- `user` (Block, Optional) The user dictionary values override the `default_user` configuration from `/etc/cloud/cloud.cfg`. The user dictionary keys supported for the `default_user` are the same as the users schema. (see [below for nested schema](#nestedblock--user))
- `users` (Block List) List of users (see [below for nested schema](#nestedblock--users))

### Read-Only

- `content` (String, Sensitive) YAML content of cloud-init file

<a id="nestedblock--apk_repos"></a>
### Nested Schema for `apk_repos`

Optional:

- `alpine_repo` (Block, Optional) (see [below for nested schema](#nestedblock--apk_repos--alpine_repo))
- `local_repo_base_url` (String) The base URL of an Alpine repository containing unofficial packages.
- `preserve_repositories` (Boolean) By default, cloud-init will generate a new repositories file /etc/apk/repositories based on any valid configuration settings specified within a apk_repos section of cloud config. To disable this behavior and preserve the repositories file from the pristine image, set **preserve_repositories** to true.
The **preserve_repositories** option overrides all other config keys that would alter /etc/apk/repositories.

<a id="nestedblock--apk_repos--alpine_repo"></a>
### Nested Schema for `apk_repos.alpine_repo`

Optional:

- `base_url` (String) The base URL of an Alpine repository, or mirror, to download official packages from. If not specified then it defaults to https://alpine.global.ssl.fastly.net/alpine.
- `community_enabled` (Boolean) Whether to add the Community repo to the repositories file. By default the Community repo is not included.
- `testing_enabled` (Boolean) Whether to add the Testing repo to the repositories file. By default the Testing repo is not included. It is only recommended to use the Testing repo on a machine running the Edge version of Alpine as packages installed from Testing may have dependencies that conflict with those in non-Edge Main or Community repos.
- `version` (String) version



<a id="nestedblock--apt_pipelining"></a>
### Nested Schema for `apt_pipelining`

Optional:

- `depth` (Number) Manually specify pipeline depth. This is not recommended.
- `disable` (Boolean) Disable pipelining altogether
- `os` (Boolean) Use distro default. This is default behaivor


<a id="nestedblock--ca_certs"></a>
### Nested Schema for `ca_certs`

Optional:

- `remove_defaults` (Boolean) Remove default CA certificates if true. Default: `false`.
- `trusted` (List of String) List of trusted CA certificates to add.


<a id="nestedblock--chpasswd"></a>
### Nested Schema for `chpasswd`

Optional:

- `expire` (Boolean) Whether to expire all user passwords such that a password will need to be reset on the user’s next login. Default: `true`.
- `users` (Block List) This key represents a list of existing users to set passwords for. Each item under users contains the following required keys: *name* and *password* or in the case of a randomly generated password, *name* and *type*. The *type* key has a default value of 'hash', and may alternatively be set to 'text' or 'RANDOM'. Randomly generated passwords may be insecure, use at your own risk. (see [below for nested schema](#nestedblock--chpasswd--users))

<a id="nestedblock--chpasswd--users"></a>
### Nested Schema for `chpasswd.users`

Required:

- `name` (String) User's name

Optional:

- `password` (String) User's password
- `type` (String) The *type* key has a default value of 'hash', and may alternatively be set to 'text' or 'RANDOM'.



<a id="nestedblock--user"></a>
### Nested Schema for `user`

Optional:

- `create_groups` (Boolean) Boolean set `false` to disable creation of specified user groups. Default: `true`.
- `doas` (List of String) List of doas rules to add for a user. doas or opendoas must be installed for rules to take effect.
- `expiredate` (String) Optional. Date on which the user’s account will be disabled. Default: `null`.
- `gecos` (String) Optional comment about the user, usually a comma-separated string of real name and contact information.
- `groups` (List of String) Groups to add the user to
- `hashed_passwd` (String, Sensitive) Hash of user password to be applied. This will be applied even if the user is preexisting. To generate this hash, run: `mkpasswd --method=SHA-512 --rounds=500000`. **Note**: Your password might possibly be visible to unprivileged users on your system, depending on your cloud’s security model. Check if your cloud’s IMDS server is visible from an unprivileged user to evaluate risk.
- `homedir` (String) Optional home dir for user. Default: `/home/<username>`.
- `inactive` (String) Optional string representing the number of days until the user is disabled.
- `lock_passwd` (Boolean) Disable password login. Default: `true`.
- `name` (String) The user’s login name. Required otherwise user creation will be skipped for this user.
- `no_create_home` (Boolean) Do not create home directory. Default: `false`.
- `no_log_init` (Boolean) Do not initialize lastlog and faillog for user. Default: `false`.
- `no_user_group` (Boolean) Do not create group named after user. Default: `false`.
- `passwd` (String, Sensitive) Hash of user password applied when user does not exist. This will NOT be applied if the user already exists. To generate this hash, run: `mkpasswd --method=SHA-512 --rounds=500000` **Note**: Your password might possibly be visible to unprivileged users on your system, depending on your cloud’s security model. Check if your cloud’s IMDS server is visible from an unprivileged user to evaluate risk.
- `plain_text_passwd` (String, Sensitive) Clear text of user password to be applied. This will be applied even if the user is preexisting. **Note**: SSH keys or certificates are a safer choice for logging in to your system. For local escalation, supplying a hashed password is a safer choice than plain text. Your password might possibly be visible to unprivileged users on your system, depending on your cloud’s security model. An exposed plain text password is an immediate security concern. Check if your cloud’s IMDS server is visible from an unprivileged user to evaluate risk.
- `primary_group` (String) Primary group for user. Default: `<username>`.
- `selinux_user` (String) SELinux user for user’s login. Default: the default SELinux user.
- `shell` (String) Path to the user’s login shell. Default: the host system’s default shell.
- `snapuser` (String) Specify an email address to create the user as a Snappy user through snap `create-user`. If an Ubuntu SSO account is associated with the address, username and SSH keys will be requested from there.
- `ssh_authorized_keys` (List of String) List of SSH keys to add to user’s authkeys file. Can not be combined with **ssh_redirect_user**.
- `ssh_import_id` (List of String) List of ssh ids to import for user. Can not be combined with ssh_redirect_user.
- `ssh_redirect_user` (Boolean) Boolean set to true to disable SSH logins for this user. When specified, all cloud-provided public SSH keys will be set up in a disabled state for this username. Any SSH login as this username will timeout and prompt with a message to login instead as the **default_username** for this instance. Default: `false`. This key can not be combined with **ssh_import_id** or **ssh_authorized_keys**.
- `sudo` (List of String) Changed in version 22.2.The value ``false`` is deprecated for this key, use ``null`` instead.
- `system` (Boolean) Create user as system user with no home directory. Default: `false`.
- `uid` (Number) The user’s ID. Default value [system default].


<a id="nestedblock--users"></a>
### Nested Schema for `users`

Optional:

- `create_groups` (Boolean) Boolean set `false` to disable creation of specified user groups. Default: `true`.
- `doas` (List of String) List of doas rules to add for a user. doas or opendoas must be installed for rules to take effect.
- `expiredate` (String) Optional. Date on which the user’s account will be disabled. Default: `null`.
- `gecos` (String) Optional comment about the user, usually a comma-separated string of real name and contact information.
- `groups` (List of String) Groups to add the user to
- `hashed_passwd` (String, Sensitive) Hash of user password to be applied. This will be applied even if the user is preexisting. To generate this hash, run: `mkpasswd --method=SHA-512 --rounds=500000`. **Note**: Your password might possibly be visible to unprivileged users on your system, depending on your cloud’s security model. Check if your cloud’s IMDS server is visible from an unprivileged user to evaluate risk.
- `homedir` (String) Optional home dir for user. Default: `/home/<username>`.
- `inactive` (String) Optional string representing the number of days until the user is disabled.
- `lock_passwd` (Boolean) Disable password login. Default: `true`.
- `name` (String) The user’s login name. Required otherwise user creation will be skipped for this user.
- `no_create_home` (Boolean) Do not create home directory. Default: `false`.
- `no_log_init` (Boolean) Do not initialize lastlog and faillog for user. Default: `false`.
- `no_user_group` (Boolean) Do not create group named after user. Default: `false`.
- `passwd` (String, Sensitive) Hash of user password applied when user does not exist. This will NOT be applied if the user already exists. To generate this hash, run: `mkpasswd --method=SHA-512 --rounds=500000` **Note**: Your password might possibly be visible to unprivileged users on your system, depending on your cloud’s security model. Check if your cloud’s IMDS server is visible from an unprivileged user to evaluate risk.
- `plain_text_passwd` (String, Sensitive) Clear text of user password to be applied. This will be applied even if the user is preexisting. **Note**: SSH keys or certificates are a safer choice for logging in to your system. For local escalation, supplying a hashed password is a safer choice than plain text. Your password might possibly be visible to unprivileged users on your system, depending on your cloud’s security model. An exposed plain text password is an immediate security concern. Check if your cloud’s IMDS server is visible from an unprivileged user to evaluate risk.
- `primary_group` (String) Primary group for user. Default: `<username>`.
- `selinux_user` (String) SELinux user for user’s login. Default: the default SELinux user.
- `shell` (String) Path to the user’s login shell. Default: the host system’s default shell.
- `snapuser` (String) Specify an email address to create the user as a Snappy user through snap `create-user`. If an Ubuntu SSO account is associated with the address, username and SSH keys will be requested from there.
- `ssh_authorized_keys` (List of String) List of SSH keys to add to user’s authkeys file. Can not be combined with **ssh_redirect_user**.
- `ssh_import_id` (List of String) List of ssh ids to import for user. Can not be combined with ssh_redirect_user.
- `ssh_redirect_user` (Boolean) Boolean set to true to disable SSH logins for this user. When specified, all cloud-provided public SSH keys will be set up in a disabled state for this username. Any SSH login as this username will timeout and prompt with a message to login instead as the **default_username** for this instance. Default: `false`. This key can not be combined with **ssh_import_id** or **ssh_authorized_keys**.
- `sudo` (List of String) Changed in version 22.2.The value ``false`` is deprecated for this key, use ``null`` instead.
- `system` (Boolean) Create user as system user with no home directory. Default: `false`.
- `uid` (Number) The user’s ID. Default value [system default].
